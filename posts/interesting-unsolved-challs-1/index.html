<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Unsolved Challs from Local CTFs #1 &#183; Home</title><meta name=title content="Unsolved Challs from Local CTFs #1 &#183; Home"><meta name=keywords content="ctf,AES,Block Cipher,Subset Sum,Subset Product,"><link rel=canonical href=https://etynso.github.io/posts/interesting-unsolved-challs-1/><meta name=author content="Etynso"><link href=https://discordapp.com/users/227017299939426304 rel=me><meta property="og:url" content="https://etynso.github.io/posts/interesting-unsolved-challs-1/"><meta property="og:site_name" content="Home"><meta property="og:title" content="Unsolved Challs from Local CTFs #1"><meta property="og:description" content="Unsolved Challs from Local CTFs #1 # Recently, two local CTFs were held which I didn’t have the chance to participate in, it had some unsolved crypto challs which I decided to solve outside of the CTFs :)
Wreck IT CTF 6.0 # I didn’t participate in Wreck IT CTF 6.0 which was open to public, but I “participated” via discord chat with the crypto legend azuketto. Until the end of the CTF only 1/4 crypto challs had any solve (and of course it had one solve). For this writeup I will be covering 2 challenges on AES CBC which I find to be a fresh breath of air amidst all the number theory stuff, as it had been a while since block cipher challenges appeared in local CTFs."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-17T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-17T00:00:00+00:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="AES"><meta property="article:tag" content="Block Cipher"><meta property="article:tag" content="Subset Sum"><meta property="article:tag" content="Subset Product"><meta property="og:image" content="https://etynso.github.io/posts/interesting-unsolved-challs-1/feature-unsolved.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://etynso.github.io/posts/interesting-unsolved-challs-1/feature-unsolved.png"><meta name=twitter:title content="Unsolved Challs from Local CTFs #1"><meta name=twitter:description content="Unsolved Challs from Local CTFs #1 # Recently, two local CTFs were held which I didn’t have the chance to participate in, it had some unsolved crypto challs which I decided to solve outside of the CTFs :)
Wreck IT CTF 6.0 # I didn’t participate in Wreck IT CTF 6.0 which was open to public, but I “participated” via discord chat with the crypto legend azuketto. Until the end of the CTF only 1/4 crypto challs had any solve (and of course it had one solve). For this writeup I will be covering 2 challenges on AES CBC which I find to be a fresh breath of air amidst all the number theory stuff, as it had been a while since block cipher challenges appeared in local CTFs."><link type=text/css rel=stylesheet href=/css/main.bundle.min.b7ce21e769d6628e6248cdb26ce615b731faad1d06a301b53f59a9fcf98335a55ab82fd0d6084fae0b9ff88a930e0b9e4be02d450c07942f5c220976795ac41e.css integrity="sha512-t84h52nWYo5iSM2ybOYVtzH6rR0GowG1P1mp/PmDNaVauC/Q1ghPrguf+IqTDgueS+AtRQwHlC9cIgl2eVrEHg=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP+pSqMXxm6JPOUeAg==" data-copy=Copy data-copied=Copied></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link type=text/css rel=stylesheet href=/lib/katex/katex.min.aeed31e00db047821b2deca55b28fddf49d5a4e0351850d0aa2662b36ffa6d9f79268751965d7c331ac6d862b68ad6f403dc22ec50769d9b0cb439e967e39ca9.css integrity="sha512-ru0x4A2wR4IbLeylWyj930nVpOA1GFDQqiZis2/6bZ95JodRll18MxrG2GK2itb0A9wi7FB2nZsMtDnpZ+OcqQ=="><script defer type=text/javascript src=/js/katex.bundle.2a5e0f220f8881fb35c61f68c2335b1e7b289d5beea86db4b5062b597c5fe4d0240a5cee09cde8709e498fa9bb44eabbe19a359371f9ea1f77e649a4096a3940.js integrity="sha512-Kl4PIg+Igfs1xh9owjNbHnsonVvuqG20tQYrWXxf5NAkClzuCc3ocJ5Jj6m7ROq74Zo1k3H56h935kmkCWo5QA==" id=katex-render></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Unsolved Challs from Local CTFs #1","headline":"Unsolved Challs from Local CTFs #1","abstract":"\u003ch1 class=\u0022relative group\u0022\u003eUnsolved Challs from Local CTFs #1\n    \u003cdiv id=\u0022unsolved-challs-from-local-ctfs-1\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#unsolved-challs-from-local-ctfs-1\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h1\u003e\n\u003cp\u003eRecently, two local CTFs were held which I didn\u0026rsquo;t have the chance to participate in, it had some unsolved crypto challs which I decided to solve outside of the CTFs :)\u003c\/p\u003e\n\n\u003ch2 class=\u0022relative group\u0022\u003eWreck IT CTF 6.0\n    \u003cdiv id=\u0022wreck-it-ctf-60\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#wreck-it-ctf-60\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h2\u003e\n\u003cp\u003eI didn\u0026rsquo;t participate in Wreck IT CTF 6.0 which was open to public, but I \u0026ldquo;participated\u0026rdquo; via discord chat with the crypto legend \u003ccode\u003eazuketto\u003c\/code\u003e. Until the end of the CTF only 1\/4 crypto challs had any solve (and of course it had one solve). For this writeup I will be covering 2 challenges on AES CBC which I find to be a fresh breath of air amidst all the number theory stuff, as it had been a while since block cipher challenges appeared in local CTFs.\u003c\/p\u003e","inLanguage":"en","url":"https:\/\/etynso.github.io\/posts\/interesting-unsolved-challs-1\/","author":{"@type":"Person","name":"Etynso"},"copyrightYear":"2025","dateCreated":"2025-11-17T00:00:00\u002b00:00","datePublished":"2025-11-17T00:00:00\u002b00:00","dateModified":"2025-11-17T00:00:00\u002b00:00","keywords":["ctf","AES","Block Cipher","Subset Sum","Subset Product"],"mainEntityOfPage":"true","wordCount":"3453"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">Home</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Posts title=Posts><p class="text-base font-medium">Posts</p></a><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-base font-medium">Tags</p></a><a href=/about/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=About title=About><p class="text-base font-medium">About</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Posts title=Posts><p class="text-bg font-bg">Posts</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-bg font-bg">Tags</p></a></li><li class=mt-1><a href=/about/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=About title=About><p class="text-bg font-bg">About</p></a></li></ul></div></div></div></div></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/posts/interesting-unsolved-challs-1/feature-unsolved_hu_5ad3158e55d7440d.png alt="Unsolved Challs from Local CTFs #1" loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/posts/interesting-unsolved-challs-1/feature-unsolved_hu_5ad3158e55d7440d.png></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Home</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/interesting-unsolved-challs-1/>Unsolved Challs from Local CTFs #1</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Unsolved Challs from Local CTFs #1</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-11-17T00:00:00+00:00>17 November 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3453 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">17 mins</span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt=Etynso src=/b39b5997fa7a6847c18ff2db782e38cc_2842435296422576336_hu_6b4ecfe33ece6e18.png data-zoom-src=/b39b5997fa7a6847c18ff2db782e38cc_2842435296422576336.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Etynso</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Write-ups, notes, and other stuffs.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://discordapp.com/users/227017299939426304 target=_blank aria-label=Discordapp title=Discordapp rel="me noopener noreferrer"><span class="inline-block align-text-bottom"></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#wreck-it-ctf-60>Wreck IT CTF 6.0</a><ul><li><a href=#pharloom>Pharloom</a></li><li><a href=#abyss>Abyss</a></li></ul></li><li><a href=#schematics-ctf-2025>Schematics CTF 2025</a><ul><li><a href=#fracture-ray>Fracture Ray</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#wreck-it-ctf-60>Wreck IT CTF 6.0</a><ul><li><a href=#pharloom>Pharloom</a></li><li><a href=#abyss>Abyss</a></li></ul></li><li><a href=#schematics-ctf-2025>Schematics CTF 2025</a><ul><li><a href=#fracture-ray>Fracture Ray</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h1 class="relative group">Unsolved Challs from Local CTFs #1<div id=unsolved-challs-from-local-ctfs-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#unsolved-challs-from-local-ctfs-1 aria-label=Anchor>#</a></span></h1><p>Recently, two local CTFs were held which I didn&rsquo;t have the chance to participate in, it had some unsolved crypto challs which I decided to solve outside of the CTFs :)</p><h2 class="relative group">Wreck IT CTF 6.0<div id=wreck-it-ctf-60 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#wreck-it-ctf-60 aria-label=Anchor>#</a></span></h2><p>I didn&rsquo;t participate in Wreck IT CTF 6.0 which was open to public, but I &ldquo;participated&rdquo; via discord chat with the crypto legend <code>azuketto</code>. Until the end of the CTF only 1/4 crypto challs had any solve (and of course it had one solve). For this writeup I will be covering 2 challenges on AES CBC which I find to be a fresh breath of air amidst all the number theory stuff, as it had been a while since block cipher challenges appeared in local CTFs.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Azuketto Gives Chall" src=/images/unsolved_1/wreckit-discord.png></figure></p><h3 class="relative group">Pharloom<div id=pharloom class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#pharloom aria-label=Anchor>#</a></span></h3><p>Technically this challenge is not unsolved as it had 1 solve at the end of the CTF, but I&rsquo;m covering it here since it relates with the next chall.</p><h4 class="relative group">Source Code:<div id=source-code class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#source-code aria-label=Anchor>#</a></span></h4><details><summary>chall.py</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span><span class=p>,</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>md5</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>FLAG</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>K</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>K</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>K</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>pad</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>iv</span> <span class=o>=</span> <span class=n>md5</span><span class=p>(</span><span class=n>pt</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ct</span> <span class=o>=</span> <span class=n>pt</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>K</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>KEY</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>        <span class=n>ct</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>iv</span><span class=p>,</span> <span class=n>ct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>iv</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>K</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>KEY</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>        <span class=n>pt</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>pt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>unpad</span><span class=p>(</span><span class=n>pt</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>chall</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>KEY</span>
</span></span><span class=line><span class=cl>    <span class=n>IV</span><span class=p>,</span> <span class=n>CT</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>FLAG</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>choice</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;&gt;&gt; &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Encrypt</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>iv</span><span class=p>,</span> <span class=n>ct</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>ct</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>iv</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;IV (hex): &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>pt</span> <span class=o>=</span> <span class=n>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>ct</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Flag</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>IV</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>CT</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>IV</span><span class=p>,</span> <span class=n>CT</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>FLAG</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Done&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Bye&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Nope&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>chall</span><span class=p>()</span>
</span></span></code></pre></div></details><h4 class="relative group">Problem Statement<div id=problem-statement class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#problem-statement aria-label=Anchor>#</a></span></h4><p>The challenge exposes a simple AES-CBC service with two oracles and a flag dump. Everything is encrypted using a single global 16-byte AES key and <strong>CBC applied twice</strong> (<code>K = 2</code>). The important part is that the IV is not random — it is deterministically computed as:</p><pre tabindex=0><code>IV = md5(pad(pt))[:16]
</code></pre><p>The service offers:</p><ol><li><p><strong>Encrypt arbitrary data</strong><br>You provide a plaintext <code>data</code> in hex, it is padded, its IV is computed from that padded plaintext, and then the server returns the ciphertext after running <strong>two rounds of AES-CBC with the same IV</strong>.</p></li><li><p><strong>Decrypt arbitrary data</strong><br>You send any ciphertext and any IV you want, and the server decrypts it through the same two CBC layers and finally unpads it.</p></li><li><p><strong>Get the flag ciphertext</strong><br>The server prints:</p><ul><li>the IV used for the flag</li><li>the ciphertext of <code>FLAG</code> encrypted under the same double-CBC scheme.</li></ul></li><li><p><strong>Reset the key</strong><br>Regenerates the AES key and re-encrypts the flag.</p></li></ol><p>So the interaction model is: an <strong>encrypt oracle with fixed deterministic IV</strong>, a <strong>decrypt oracle with user-controlled IV</strong>, and the <strong>flag encrypted once under the global key</strong>.</p><h4 class="relative group">Initial Thoughts<div id=initial-thoughts class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#initial-thoughts aria-label=Anchor>#</a></span></h4><p>I noticed there&rsquo;s a clear padding oracle in decrypt, as exceptions are handled by printing <code>'Nope'</code> without terminating the script. The question now becomes: how do we leverage this padding oracle under this weird encryption scheme?</p><p>So I scribbled some things to figure out what it&rsquo;s doing and pretty quickly got this! (I cleaned it up a bit):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>iv</span> <span class=n>pt1</span> <span class=n>pt2</span> <span class=n>pt3</span>
</span></span><span class=line><span class=cl><span class=n>E</span><span class=p>(</span><span class=n>pt1</span> <span class=o>^</span> <span class=n>iv</span><span class=p>)</span> <span class=o>==</span> <span class=n>ct1</span> <span class=o>|</span> <span class=n>E</span><span class=p>(</span><span class=n>ct1</span> <span class=o>^</span> <span class=n>pt2</span><span class=p>)</span> <span class=o>==</span> <span class=n>ct2</span>
</span></span><span class=line><span class=cl><span class=n>E</span><span class=p>(</span><span class=n>ct1</span> <span class=o>^</span> <span class=n>iv</span><span class=p>)</span> <span class=o>==</span> <span class=n>ctt1</span> <span class=o>|</span> <span class=n>E</span><span class=p>(</span><span class=n>ctt1</span> <span class=o>^</span> <span class=n>ct2</span><span class=p>)</span> <span class=o>==</span> <span class=n>ctt2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ivf</span> <span class=n>ctt1</span> <span class=n>ctt2</span>
</span></span><span class=line><span class=cl><span class=n>D</span><span class=p>(</span><span class=n>ctt1</span><span class=p>)</span> <span class=o>^</span> <span class=n>ivf</span> <span class=o>=</span> <span class=n>ct1</span> <span class=o>^</span> <span class=n>ivf</span> <span class=o>|</span> <span class=n>D</span><span class=p>(</span><span class=n>ctt2</span><span class=p>)</span> <span class=o>^</span> <span class=n>ctt1</span> <span class=o>=</span> <span class=n>ct2</span>
</span></span><span class=line><span class=cl><span class=n>D</span><span class=p>(</span><span class=n>ct1</span> <span class=o>^</span> <span class=n>ivf</span><span class=p>)</span> <span class=o>^</span> <span class=n>ivf</span> <span class=o>|</span> <span class=n>D</span><span class=p>(</span><span class=n>ct2</span><span class=p>)</span> <span class=o>^</span> <span class=n>ct1</span> <span class=o>^</span> <span class=n>ivf</span> <span class=o>=</span> <span class=n>pt2</span> <span class=o>^</span> <span class=n>ivf</span> <span class=p>(</span><span class=n>This</span> <span class=ow>is</span> <span class=n>Where</span> <span class=n>the</span> <span class=n>padding</span> <span class=n>oracle</span> <span class=ow>is</span><span class=p>)</span>
</span></span></code></pre></div><p>The scribbling describes itself! Here <code>ivf</code> is the forged IV, and the way to get a padding oracle is that this forged IV will eventually be XORed into the decryption result of the second block — the same way the previous block is XORed in a normal padding oracle attack.</p><p>But notice: we <strong>cannot</strong> use the padding oracle to decrypt the first block, because we require another block <em>before</em> the block we want to decrypt. I tried to find some trick because I thought I missed something, but after confirming with the author, the flag prefix is long and the remaining characters are hex. This means out of the 16 characters in the first block, we know:</p><pre tabindex=0><code>WRECKIT60{
</code></pre><p>and the remaining 6 characters are lowercase hex chars:</p><pre tabindex=0><code>16^6 = 16,777,216 possibilities
</code></pre><p>Which is brute-forceable using the IV and MD5 hash as validator.</p><details><summary>solve.py</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span><span class=o>,</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-------------------------</span>
</span></span><span class=line><span class=cl><span class=n>connect</span> <span class=o>+</span> <span class=n>helpers</span> <span class=p>(</span><span class=n>yours</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-------------------------</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;143.198.215.203&#34;</span><span class=p>,</span> <span class=mi>8031</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>oracle</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>iv</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>target</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt;&gt; &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>target</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>target</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;IV (hex): &#34;</span><span class=p>,</span> <span class=n>iv</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>line</span> <span class=o>=</span> <span class=n>target</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s2>&#34;Nope&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>line</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_enc</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>target</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt;&gt; &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>IV</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>target</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>CT</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>target</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>CT</span><span class=p>,</span> <span class=n>IV</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>prime_oracle</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>do</span> <span class=n>one</span> <span class=n>encrypt</span> <span class=n>so</span> <span class=n>menu</span> <span class=mi>2</span> <span class=n>prints</span> <span class=n>something</span> <span class=n>on</span> <span class=n>success</span>
</span></span><span class=line><span class=cl>    <span class=n>target</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt;&gt; &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>target</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;00&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-------------------------</span>
</span></span><span class=line><span class=cl><span class=n>K</span><span class=o>=</span><span class=mi>2</span> <span class=n>CBC</span> <span class=n>padding</span> <span class=n>attack</span> <span class=k>for</span> <span class=n>P2</span><span class=o>..</span><span class=n>Pn</span> <span class=p>(</span><span class=n>unchanged</span> <span class=n>logic</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-------------------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>chunk16</span><span class=p>(</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>16</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>b</span><span class=p>),</span> <span class=mi>16</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>recover_block</span><span class=p>(</span><span class=n>prev2</span><span class=p>,</span> <span class=n>prev1</span><span class=p>,</span> <span class=n>block</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>prev1</span> <span class=o>+</span> <span class=n>block</span>
</span></span><span class=line><span class=cl>    <span class=n>plain</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>pad</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>17</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=mi>16</span> <span class=o>-</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl>        <span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>g</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>iv_try</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=n>prev2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>set</span> <span class=n>already</span> <span class=n>solved</span> <span class=n>suffix</span> <span class=n>to</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>pad</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>iv_try</span><span class=p>[</span><span class=o>-</span><span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=n>plain</span><span class=p>[</span><span class=o>-</span><span class=n>j</span><span class=p>]</span> <span class=o>^</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl>            <span class=nb>set</span> <span class=n>guess</span> <span class=n>on</span> <span class=n>current</span> <span class=n>byte</span>
</span></span><span class=line><span class=cl>            <span class=n>iv_try</span><span class=p>[</span><span class=o>-</span><span class=n>pad</span><span class=p>]</span> <span class=o>^=</span> <span class=n>g</span>
</span></span><span class=line><span class=cl>            <span class=n>small</span> <span class=n>guard</span> <span class=n>to</span> <span class=n>avoid</span> <span class=n>trivial</span> <span class=n>p</span><span class=o>==</span><span class=mi>1</span> <span class=n>hit</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pad</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>iv_try</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>^=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>oracle</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>iv_try</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                <span class=n>real</span> <span class=n>plaintext</span> <span class=n>byte</span> <span class=o>=</span> <span class=n>pad</span> <span class=err>⊕</span> <span class=n>orig_prev2</span> <span class=err>⊕</span> <span class=n>forged_prev2</span>
</span></span><span class=line><span class=cl>                <span class=n>plain</span><span class=p>[</span><span class=o>-</span><span class=n>pad</span><span class=p>]</span> <span class=o>=</span> <span class=n>pad</span> <span class=o>^</span> <span class=n>prev2</span><span class=p>[</span><span class=o>-</span><span class=n>pad</span><span class=p>]</span> <span class=o>^</span> <span class=n>iv_try</span><span class=p>[</span><span class=o>-</span><span class=n>pad</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>found</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;no byte found at pad=</span><span class=si>{</span><span class=n>pad</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>plain</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>recover_tail</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>prime_oracle</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>CT</span><span class=p>,</span> <span class=n>IVF</span> <span class=o>=</span> <span class=n>get_enc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>blocks</span> <span class=o>=</span> <span class=p>[</span><span class=n>IVF</span><span class=p>]</span> <span class=o>+</span> <span class=n>chunk16</span><span class=p>(</span><span class=n>CT</span><span class=p>)</span>  <span class=n>C0</span><span class=o>=</span><span class=n>IVF</span><span class=p>,</span> <span class=n>C1</span><span class=o>..</span><span class=n>Cn</span>
</span></span><span class=line><span class=cl>    <span class=n>recovered</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=nb>len</span><span class=p>(</span><span class=n>blocks</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>prev2</span><span class=p>,</span> <span class=n>prev1</span><span class=p>,</span> <span class=n>blk</span> <span class=o>=</span> <span class=n>blocks</span><span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>],</span> <span class=n>blocks</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>],</span> <span class=n>blocks</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>pblk</span> <span class=o>=</span> <span class=n>recover_block</span><span class=p>(</span><span class=n>prev2</span><span class=p>,</span> <span class=n>prev1</span><span class=p>,</span> <span class=n>blk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>recovered</span> <span class=o>=</span> <span class=n>pblk</span> <span class=o>+</span> <span class=n>recovered</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>recovered</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>blocks</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>remaining</span> <span class=p>[</span><span class=n>IVF</span><span class=p>,</span> <span class=n>C1</span><span class=p>]</span> <span class=err>—</span> <span class=n>P1</span> <span class=ow>not</span> <span class=n>recoverable</span> <span class=n>via</span> <span class=n>oracle</span><span class=p>;</span> <span class=k>return</span> <span class=n>tail</span> <span class=ow>and</span> <span class=n>IVF</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>recovered</span><span class=p>,</span> <span class=n>IVF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-------------------------</span>
</span></span><span class=line><span class=cl><span class=n>Brute</span> <span class=n>P1</span> <span class=n>using</span> <span class=n>md5</span><span class=p>(</span><span class=n>P1</span><span class=o>||</span><span class=n>tail</span><span class=p>)[:</span><span class=mi>16</span><span class=p>]</span> <span class=o>==</span> <span class=n>IVF</span>
</span></span><span class=line><span class=cl><span class=n>First</span> <span class=n>block</span> <span class=n>must</span> <span class=n>be</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&#34;WRECKIT60{&#34;</span> <span class=o>+</span> <span class=n>six</span> <span class=nb>hex</span> <span class=n>chars</span> <span class=p>(</span><span class=n>lowercase</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-------------------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>brute_first_block</span><span class=p>(</span><span class=n>ivf</span><span class=p>,</span> <span class=n>tail</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>prefix</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;WRECKIT60{&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>prefix</span><span class=p>)</span> <span class=o>==</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=n>alphabet</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;0123456789abcdef&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>tup</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=n>alphabet</span><span class=p>,</span> <span class=n>repeat</span><span class=o>=</span><span class=mi>6</span><span class=p>):</span>  <span class=mi>16</span><span class=o>^</span><span class=mi>6</span> <span class=o>=</span> <span class=mi>16</span><span class=p>,</span><span class=mi>777</span><span class=p>,</span><span class=mi>216</span>
</span></span><span class=line><span class=cl>        <span class=n>p1</span> <span class=o>=</span> <span class=n>prefix</span> <span class=o>+</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>tup</span><span class=p>)</span>  <span class=mi>10</span> <span class=o>+</span> <span class=mi>6</span> <span class=o>=</span> <span class=mi>16</span> <span class=nb>bytes</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>p1</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>]</span> <span class=o>==</span> <span class=n>ivf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>p1</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=p>,</span> <span class=n>ivf</span> <span class=o>=</span> <span class=n>recover_tail</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Recovered tail length: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>tail</span><span class=p>)</span><span class=si>}</span><span class=s2> bytes (P2..Pn).&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span> <span class=o>=</span> <span class=n>brute_first_block</span><span class=p>(</span><span class=n>ivf</span><span class=p>,</span> <span class=n>tail</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>p1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] P1 not found in 16^6 space (unexpected for this flag format).&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>tail</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=n>full_pt</span> <span class=o>=</span> <span class=n>p1</span> <span class=o>+</span> <span class=n>tail</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>=</span> <span class=n>unpad</span><span class=p>(</span><span class=n>full_pt</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>,</span> <span class=s1>&#39;replace&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] FLAG: </span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Full plaintext (hex): </span><span class=si>{</span><span class=p>(</span><span class=n>p1</span><span class=o>+</span><span class=n>tail</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div></details><h3 class="relative group">Abyss<div id=abyss class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#abyss aria-label=Anchor>#</a></span></h3><h4 class="relative group">Source Code:<div id=source-code-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#source-code-1 aria-label=Anchor>#</a></span></h4><details><summary>chall.py</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span><span class=p>,</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>md5</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>FLAG</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>K</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ecb_encrypt</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span> <span class=p>:</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>KEY</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ecb_decrypt</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span> <span class=p>:</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>KEY</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>to_blocks</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span> <span class=p>:</span> <span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>16</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=mi>16</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>iv</span><span class=p>:</span> <span class=nb>bytes</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>pad</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>iv</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span> <span class=n>iv</span> <span class=o>=</span> <span class=n>md5</span><span class=p>(</span><span class=n>pt</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>ct</span> <span class=o>=</span> <span class=n>pt</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>KEY</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>K</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>ct</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>iv</span><span class=p>,</span> <span class=n>ct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>iv</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>KEY</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>K</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>pt</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>pt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>pt</span><span class=p>[</span><span class=o>-</span><span class=mi>16</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>chall</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>KEY</span>
</span></span><span class=line><span class=cl>    <span class=n>IV</span><span class=p>,</span> <span class=n>CT</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>FLAG</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>choice</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;&gt;&gt; &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Encrypt</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>iv</span><span class=p>,</span> <span class=n>ct</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>ct</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>iv</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;IV (hex): &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>pt</span> <span class=o>=</span> <span class=n>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>pt</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Flag</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>IV</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>CT</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>IV</span><span class=p>,</span> <span class=n>CT</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>FLAG</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Done&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Bye&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Nope&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>chall</span><span class=p>()</span>
</span></span></code></pre></div></details><h4 class="relative group">Problem Statement<div id=problem-statement-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#problem-statement-1 aria-label=Anchor>#</a></span></h4><p>This challenge exposes another AES-based oracle, again using a single global 16-byte key and <strong>CBC applied twice</strong> (<code>K = 2</code>), but with two major differences from <em>Pharloom</em>:</p><ol><li>The cipher&rsquo;s IV isn&rsquo;t reset — meaning the IV for the second CBC pass begins as the <strong>last ciphertext block</strong> of the first pass.</li><li>The decryption oracle <strong>never unpads</strong>; instead, it returns <strong>only the final 16-byte block</strong> after the two-layer CBC decryption.</li><li>The encryption oracle lets you <strong>optionally override the IV</strong>, but when omitted it is once again:</li></ol><pre tabindex=0><code>IV = md5(pad(pt))[:16]
</code></pre><p>The service gives:</p><ol><li><strong>Encrypt arbitrary data</strong> — plaintext is padded, the IV is derived (or user-supplied), and ciphertext is produced via double CBC.</li><li><strong>Decrypt arbitrary data</strong> — returns only the last block after double decryption.</li><li><strong>Flag ciphertext</strong> — prints the flag IV and ciphertext.</li><li><strong>Reset key</strong> — regenerates key + re-encrypts the flag.</li></ol><p>Unlike <em>Pharloom</em>, there is <strong>no padding oracle</strong> here — the decrypt path never raises <code>unpad()</code>.</p><h4 class="relative group">Initial Thoughts<div id=initial-thoughts-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#initial-thoughts-1 aria-label=Anchor>#</a></span></h4><p>This challenge initially seems a lot tougher as the vulnerability isn&rsquo;t obvious! Actually, there&rsquo;s an obvious vulnerability which LLM could figure out, that is the decryption actually yields the correct final block for number of block size >= 3. I wasted some time on this, but it turns out that this leads nowhere as the first and second blocks are still missing. So instead i turn my head to the <strong>encryption</strong> service and do some scribbling</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>Encrypt</span>
</span></span><span class=line><span class=cl><span class=n>x</span>
</span></span><span class=line><span class=cl><span class=n>E</span><span class=p>(</span><span class=n>md5</span> <span class=o>^</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E</span><span class=p>(</span><span class=n>E</span><span class=p>(</span><span class=n>md5</span> <span class=o>^</span> <span class=n>x</span><span class=p>)</span> <span class=o>^</span> <span class=n>E</span><span class=p>(</span><span class=n>md5</span> <span class=o>^</span> <span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>gives</span> <span class=n>encryption</span> <span class=n>of</span> <span class=n>zero</span>
</span></span></code></pre></div><p>Okay, as it turns out when we encrypt only one block, we get encryption of zero! I knew, this would be big and we can leverage it in decrypt as such</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>iv</span>
</span></span><span class=line><span class=cl><span class=n>E</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>D</span><span class=p>(</span><span class=n>E</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span> <span class=o>^</span> <span class=n>iv</span> <span class=o>=</span> <span class=n>iv</span>
</span></span><span class=line><span class=cl><span class=n>D</span><span class=p>(</span><span class=n>iv</span><span class=p>)</span> <span class=o>^</span> <span class=n>E</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>     <span class=p>(</span><span class=n>this</span> <span class=ow>is</span> <span class=n>what</span> <span class=n>decrypt</span> <span class=n>returns</span><span class=p>)</span>
</span></span></code></pre></div><p>So, by decrypting the encryption of zero, we get decryption of iv xored with encryption of zero. Since we know what the encryption of zero is, we can then xor it with the output to get the decryption of iv. Since we can choose our iv this effectively becomes an ECB decryption oracle! Then, everything else is easy.</p><details><summary>solve.py</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>LOCALHOST</span><span class=p>,</span> <span class=n>PORT</span> <span class=o>=</span> <span class=s2>&#34;localhost&#34;</span><span class=p>,</span> <span class=mi>1337</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>LOCALHOST</span><span class=p>,</span> <span class=n>PORT</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>menu</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt;&gt; &#34;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>menu</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>drop</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>menu</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Data (hex): &#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;IV (hex): &#34;</span><span class=p>,</span> <span class=n>iv</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>drop</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_flag</span><span class=p>()</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>menu</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>drop</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()),</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>(</span><span class=n>drop</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>iv</span><span class=p>,</span> <span class=n>ct</span> <span class=o>=</span> <span class=n>get_flag</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>zero_enc</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ecb_decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>xor</span><span class=p>(</span><span class=n>decrypt</span><span class=p>(</span><span class=n>zero_enc</span><span class=p>,</span> <span class=n>data</span><span class=p>),</span> <span class=n>zero_enc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>cbc_decrypt_loop</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>blocks</span> <span class=o>=</span> <span class=p>[</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>16</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=mi>16</span><span class=p>)][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>block</span><span class=p>,</span> <span class=n>iv</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>blocks</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>blocks</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>xor</span><span class=p>(</span><span class=n>ecb_decrypt</span><span class=p>(</span><span class=n>block</span><span class=p>),</span> <span class=n>iv</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>xor</span><span class=p>(</span><span class=n>ecb_decrypt</span><span class=p>(</span><span class=n>blocks</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]),</span> <span class=n>result</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>cbc_decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>blocks</span> <span class=o>=</span> <span class=p>[</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>16</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=mi>16</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>last</span> <span class=o>=</span> <span class=n>iv</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>block</span> <span class=ow>in</span> <span class=n>blocks</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>xor</span><span class=p>(</span><span class=n>ecb_decrypt</span><span class=p>(</span><span class=n>block</span><span class=p>),</span> <span class=n>last</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>last</span> <span class=o>=</span> <span class=n>block</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tmp1</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>cbc_decrypt_loop</span><span class=p>(</span><span class=n>ct</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>tmp2</span> <span class=o>=</span> <span class=n>cbc_decrypt</span><span class=p>(</span><span class=n>tmp1</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>tmp2</span><span class=p>))</span>
</span></span></code></pre></div></details><h2 class="relative group">Schematics CTF 2025<div id=schematics-ctf-2025 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#schematics-ctf-2025 aria-label=Anchor>#</a></span></h2><p>Again, Schematics CTF 2025 is an event which i didn&rsquo;t participate in due to conflict with another CTF, the qualification stage challs weren&rsquo;t that interesting. I dm&rsquo;d the author regarding the final stage challenge to <del>assert dominance</del> <strong>learn from them</strong> and i found one of them to be quite interesting</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="etern1ty Gives Chall" src=/images/unsolved_1/schematics-discord.png></figure></p><h3 class="relative group">Fracture Ray<div id=fracture-ray class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#fracture-ray aria-label=Anchor>#</a></span></h3><h4 class="relative group">Source Code<div id=source-code-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#source-code-2 aria-label=Anchor>#</a></span></h4><details><summary>chall.py</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Random</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>mpz</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sympy</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>signal</span><span class=o>,</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>H</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sha3_256</span><span class=p>(</span><span class=n>tag</span> <span class=o>+</span> <span class=n>m</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sign</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=n>H</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>pow</span><span class=p>(</span><span class=n>mpz</span><span class=p>(</span><span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)),</span> <span class=n>d</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>s</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vb</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>vb</span><span class=p>[:</span><span class=mi>8</span><span class=p>]</span> <span class=o>==</span> <span class=n>H</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>getRandomInteger</span><span class=p>(</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>getRandomInteger</span><span class=p>(</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>nextprime</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>=</span> <span class=n>nextprime</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=n>e</span> <span class=o>=</span> <span class=mh>0x10001</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=n>get_random_bytes</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;N = </span><span class=si>{</span><span class=n>N</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;e = </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;tag = </span><span class=si>{</span><span class=n>tag</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>msgs</span> <span class=o>=</span> <span class=p>[</span><span class=n>get_random_bytes</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>96</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>msgs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>sign</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>hex</span><span class=p>(),</span> <span class=nb>format</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=s2>&#34;x&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>target</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;https://www.youtube.com/watch?v=1v7WXxLWSrk&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>signal</span><span class=o>.</span><span class=n>alarm</span><span class=p>(</span><span class=mi>67</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s_hex</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;s: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>s_hex</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;whuh&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>verify</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>target</span><span class=p>,</span> <span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;yay!!!! here flag: </span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;nuh uh&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div></details><h4 class="relative group">Problem Statement<div id=problem-statement-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#problem-statement-2 aria-label=Anchor>#</a></span></h4><p>This challenge implements a custom RSA signing scheme where messages are first hashed using:</p><p>$$ H(\text{tag}, m) = \text{SHA3-256}(\text{tag} | m)[:8] $$</p><p>and the signature is computed as a plain RSA exponentiation:</p><p>$$ s = H(\text{tag}, m)^d \bmod N $$</p><p>The public verification process exponentiates the signature:</p><p>$$ v = s^e \bmod N $$</p><p>and checks whether the first 8 bytes of <code>v</code> match the 8-byte digest of the message under the same keyed hash.</p><p>At the start of the challenge, the server:</p><ol><li><p>Generates two random 2048-bit integers <code>a</code> and <code>b</code>, takes their next primes <code>p = nextprime(a)</code> and <code>q = nextprime(b)</code>, and uses them to construct a 4096-bit RSA modulus:</p><p>$$ N = p \cdot q $$</p></li><li><p>Samples a random 16-byte tag used for all hashing operations.</p></li><li><p>Produces <strong>96 message–signature pairs</strong>, where each message is a random 3-byte string and each signature is correct under the unknown private key <code>d</code>.</p></li></ol><p>Your goal is to forge a valid signature <strong>on a specific target message</strong>:</p><pre tabindex=0><code>b&#34;https://www.youtube.com/watch?v=1v7WXxLWSrk&#34;
</code></pre><p>You must output a hexadecimal integer <code>s</code> such that:</p><pre tabindex=0><code>pow(s, e, N)
</code></pre><p>begins with the 8-byte value:</p><pre tabindex=0><code>H(tag, target)
</code></pre><p>If verification succeeds, the server reveals the flag.</p><p>The service provides:</p><ul><li>The RSA modulus <code>N</code> and public exponent <code>e</code>.</li><li>The secret per-session 16‑byte tag.</li><li>96 challenge signatures <code>s_i</code> for random short messages <code>m_i</code>.</li><li>A single opportunity to submit one forged signature <code>s</code> for the fixed target message.</li></ul><p>The problem thus reduces to constructing an integer <code>s</code> satisfying:</p><p>$$ s^e \equiv H(\text{tag}, \text{target}) \pmod{N} $$</p><p>without knowledge of the RSA private key.</p><h4 class="relative group">Initial Thoughts<div id=initial-thoughts-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#initial-thoughts-2 aria-label=Anchor>#</a></span></h4><p>There is a clear vulnerability that sticks out! that is why would you only use 8 bytes of the hash equaling to a 64 bits integer for the verification?</p><p>Another common rsa signature trick is that rsa is a multiplicatively homomorphic scheme, which is a fancy way of saying \(S(a) * S(b) = S(a * b)\), where a and b here are the hash of the respective message</p><p>So the win condition actually becomes rather loose, since the verification is done by decoding the signature, then converting it into bytes and checking only the first 8 bytes, this means it doesn&rsquo;t matter what the decoded signature size is as long as when it is converted to bytes the first 8 bytes is the same as the first 8 bytes of the message hash</p><p>Okay, combined with the fact that we&rsquo;re given 96 signatures from 64 bit integers, there has got to be a way to multiply them such that when converted to bytes they have the 8 bytes prefix that we want! This fact is rather obvious, what is not however is finding such product as subset product is not really an easily solvable problem especially under modulo N.</p><p>However, subset product (even under modulo N) can be turned into subset sum via logarithm, this is showcased in an obvious manner by <code>Zyan</code> on the chall <a href=https://zayn.id.vn/posts/2024/2024-10-23-ascis-ctf/ target=_blank>LoveLinhaLot</a> on Vietnam ASCIS CTF Final 2024, as well as more recently by <code>Whale120</code> on chall <a href=https://blog.whale-tw.com/2025/10/19/qnqsec-ctf-2025/#Republic-of-Geese target=_blank>Republic of Geese</a> in QnQsec ctf 2025.</p><p>The difference however is that in both of those we&rsquo;re working with discrete logarithm, while in this challenge clearly it&rsquo;s impossible to solve discrete logarithm mod N. However, the trick is that we don&rsquo;t need to do discrete logarithm, as our prefix is only 64 bits, while the modulo is 4096 bits, this means we can set our target to be 4064 bits, and there should be many solutions such that the top 64 bits are the same</p><h4 class="relative group">Subset Product → Subset Sum<div id=subset-product--subset-sum class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#subset-product--subset-sum aria-label=Anchor>#</a></span></h4><p>Before going further, let me clarify the “subset product → subset sum using logarithms” thing a bit more. In any multiplicative group \(G\), if you have elements \(g_i\) and you want to pick a subset whose product equals some target \(g\), the natural way to linearize the problem is to take logarithms:</p><p>\[
\log(g) = \log\left(\prod g_i^{c_i}\right) = \sum c_i \cdot \log(g_i)
\]</p><p>Exactly the same structure: <strong>subset product becomes subset sum</strong>.<br>The only difference is what kind of logarithm you are allowed to take.</p><ul><li>In finite fields or groups modulo a prime, this “log” is the <strong>discrete logarithm</strong>.</li><li>In \(\mathbb{R}^+\), the log is the usual real-valued logarithm.</li></ul><p>The <em>concept</em> is identical — the logarithm converts multiplication into addition — but discrete logs are usually computationally infeasible, while real logs are trivial.</p><p>In the previous CTF challenges (LoveLinhaLot and Republic of Geese), the trick worked because the challenge structure let you exploit discrete logs. But here, computing discrete log mod \(N\) is impossible.</p><p>The key observation — and the reason we can still use the trick anyway — is that <strong>we don’t need exact equality in the group</strong>.<br>The RSA verification only checks the <strong>first 8 bytes</strong> of the decoded value.<br>So instead of solving:</p><p>\[
\prod h_i^{c_i} = H_{\text{target}} \pmod{N}
\]</p><p>we only need:</p><ul><li>the <strong>top 64 bits</strong> to match,</li><li>the remaining ~4064 bits can be anything.</li></ul><p>This huge slack means we can safely treat the \(h_i\) values as regular integers and use <strong>real-valued logarithms</strong>:</p><p>\[
\log(h_i) \in \mathbb{R}
\]</p><p>Then solve the approximate subset sum:</p><p>\[
\sum c_i \cdot \log(h_i) \approx \log(H_{\text{target}} \ll 4000)
\]</p><p>The goal is simply to get the <em>magnitude</em> right.<br>Once we find coefficients \(c_i\) making the real-valued sum land in the right interval, the actual modular product:</p><p>\[
\prod h_i^{c_i} \bmod N
\]</p><p>tends to fall in the range whose <strong>top 64 bits</strong> match the needed prefix, because many such integers exist.</p><p>So, we just have to solve the subset sum problem which can be done via lattice method! Initially, i tried to construct my own lattice and reducing that, but, i end up getting negative coefficients which sadly won&rsquo;t work since those negative coefficients correspond to division in real numbers which is an operation that we can&rsquo;t mirror mod n (at least in terms of keeping the prefix). After trying to configure the lattice for a bit using CVP to get all positive solutions and failing miserably, i decided to ACTUALLY learn the correct way to solve this problem which is by using Integer Linear Programming (ILP). Thankfully, we just use <a href=https://github.com/TheBlupper/linineq/ target=_blank>Blupper&rsquo;s implementation</a> and find out it&rsquo;s super easy to use and after a bit of parameter tuning eventually gets a solution that works about 90% of the time and &lt; 10 seconds in local :D</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Fracture Solve" src=/images/unsolved_1/solve-fracture.png></figure></p><details><summary>solve.py</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha3_256</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>linineq</span> <span class=kn>import</span> <span class=n>solve_bounded</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>H</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sha3_256</span><span class=p>(</span><span class=n>tag</span> <span class=o>+</span> <span class=n>m</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;localhost&#34;</span><span class=p>,</span> <span class=mi>1337</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;N = &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;e = &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;tag = &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tag</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dim</span> <span class=o>=</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl><span class=n>samples</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>dim</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span><span class=p>,</span> <span class=n>s</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span> <span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>16</span><span class=p>),</span> <span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>samples</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>m</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=nb>pow</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>N</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>R</span> <span class=o>=</span> <span class=n>RealField</span><span class=p>(</span><span class=mi>3000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>log_s</span> <span class=o>=</span> <span class=p>[</span><span class=n>R</span><span class=p>(</span><span class=n>log_b</span><span class=p>(</span><span class=n>h</span><span class=p>))</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>h</span> <span class=ow>in</span> <span class=n>samples</span><span class=p>[:</span><span class=n>dim</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>sig_target</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;https://www.youtube.com/watch?v=1v7WXxLWSrk&#34;</span>
</span></span><span class=line><span class=cl><span class=n>actual_h</span> <span class=o>=</span> <span class=n>H</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=n>sig_target</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h_target</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>actual_h</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>4000</span>
</span></span><span class=line><span class=cl><span class=n>log_target</span> <span class=o>=</span> <span class=n>R</span><span class=p>(</span><span class=n>log_b</span><span class=p>(</span><span class=n>h_target</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>scaler</span> <span class=o>=</span> <span class=mi>2</span><span class=o>**</span><span class=mi>69</span>
</span></span><span class=line><span class=cl><span class=n>L</span> <span class=o>=</span> <span class=p>[</span><span class=n>ZZ</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>l</span> <span class=o>*</span> <span class=n>scaler</span><span class=p>))</span> <span class=k>for</span> <span class=n>l</span> <span class=ow>in</span> <span class=n>log_s</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>L_target</span> <span class=o>=</span> <span class=n>ZZ</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>log_target</span> <span class=o>*</span> <span class=n>scaler</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>M</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>(</span><span class=n>ZZ</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>dim</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>L</span> <span class=o>+</span> <span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=n>L_target</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Kmax</span> <span class=o>=</span> <span class=mi>1000</span>  
</span></span><span class=line><span class=cl><span class=n>Emax</span> <span class=o>=</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lb</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>dim</span> <span class=o>+</span> <span class=p>[</span><span class=o>-</span><span class=n>Emax</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ub</span> <span class=o>=</span> <span class=p>[</span><span class=n>Kmax</span><span class=p>]</span> <span class=o>*</span> <span class=n>dim</span> <span class=o>+</span> <span class=p>[</span> <span class=n>Emax</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>solution</span> <span class=o>=</span> <span class=n>solve_bounded</span><span class=p>(</span><span class=n>M</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>lb</span><span class=p>,</span> <span class=n>ub</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>coeffs</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>solution</span><span class=p>[:</span><span class=n>dim</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>eps</span> <span class=o>=</span> <span class=n>solution</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;coeffs:&#34;</span><span class=p>,</span> <span class=n>coeffs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;eps:&#34;</span><span class=p>,</span> <span class=n>eps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>test</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>coeff</span><span class=p>,</span> <span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>h</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>coeffs</span><span class=p>,</span> <span class=n>samples</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>test</span> <span class=o>=</span> <span class=p>(</span><span class=n>test</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=n>coeff</span><span class=p>,</span> <span class=n>N</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>test</span><span class=p>)[:</span><span class=mi>8</span><span class=p>]</span> <span class=o>==</span> <span class=n>actual_h</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>forged</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>coeff</span><span class=p>,</span> <span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>h</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>coeffs</span><span class=p>,</span> <span class=n>samples</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>forged</span> <span class=o>=</span> <span class=p>(</span><span class=n>forged</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>coeff</span><span class=p>,</span> <span class=n>N</span><span class=p>))</span> <span class=o>%</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;s: &#34;</span><span class=p>,</span> <span class=nb>hex</span><span class=p>(</span><span class=n>forged</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;That took </span><span class=si>{</span><span class=n>end</span><span class=si>}</span><span class=s2> s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></div></details><p>After consulting with the author, turns out this is an unintended way of solving which i figured since i only used 30 of the 96 given output to solve it!</p><p>Although the author didn&rsquo;t intend for it, it turns out to be a great challenge and made me learn how to do Integer Linear Programming and add it to my toolkit! :D</p></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/interesting-unsolved-challs-1/index.md data-oid-likes=likes_posts/interesting-unsolved-challs-1/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/l3akctf2025-dual-mt-drbg/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;l3akctf2025 — Dual MT DRBG
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-07-21T00:00:00+00:00>21 July 2025</time>
</span></span><span class="flex flex-col items-end"></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-24 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Etynso</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://etynso.github.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>